# CTF åŠ¨æ€é¶æœºæ¨¡æ¿

![ctf-docker-template](https://github.com/CTF-Archives/ctf-docker-template/assets/41804496/71e71631-1d10-4076-b63d-8668a7b22a5f)

## About

**ctf-docker-template** æ˜¯ä¸€ä¸ªç”¨äºæ”¯æŒåŠ¨æ€ Flag çš„Dockerå®¹å™¨æ¨¡æ¿é¡¹ç›®ï¼Œæ”¯æŒä¸»æµçš„å„ç±»CTFå¹³å°

é¡¹ç›®å­˜æœ‰ä¸€å®šå±€é™æ€§ï¼Œä½†å·²å¯é€‚ç”¨äºç»å¤§å¤šæ•°åˆä¸­çº§åˆ«é¢˜ç›®çš„å‘½é¢˜éœ€æ±‚

æœ¬ä»“åº“å†…çš„Dockerå®¹å™¨æ¨¡æ¿æ”¯æŒçš„ FLAG æ³¨å…¥ç±»å‹å¦‚ä¸‹ï¼š

- `$FLAG`ï¼ˆ[CTFd](https://github.com/CTFd/CTFd)ï¼Œ[NSSCTF](https://www.nssctf.cn/)ï¼‰
- `$GZCTF_FLAG`ï¼ˆ[GZCTF](https://github.com/GZTimeWalker/GZCTF)ï¼‰
- `$DASCTF`ï¼ˆDASCTFï¼‰

ä¸‰ç§åŠ¨æ€flagéƒ¨ç½²æ–¹å¼ï¼Œæ”¯æŒGZCTFã€CTFdã€å®‰æ’DASCTFç­‰æ”¯æŒDockeråŠ¨æ€éƒ¨ç½²é¢˜ç›®é¶æœºçš„å¹³å°

> ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒCTFé¢˜ç›®åŠ¨æ€FLAGä½¿ç”¨ç¯å¢ƒå˜é‡æ³¨å…¥çš„æ–¹å¼æ¥å®ç°:
>
> `docker run -dtP -e FLAG=HelloCTF{This1sFl4g} [imagesName:Tag]`
>
> è€Œä¸Šé¢æ‰€è¯´çš„æ³¨å…¥ç±»å‹ "`$xxx`" xxxå°±æ˜¯FLAGçš„å˜é‡åã€‚

**æœ‰é—®é¢˜è¯·å¼€issueï¼Œå¥½ç”¨è¯·ç‚¹starï¼Œæœ‰é—®é¢˜çš„è¯æ¬¢è¿é€šè¿‡ [CTF-Archiveså”®åå¿«é€ŸæœåŠ¡ç¾¤](http://qm.qq.com/cgi-bin/qm/qr?_wv=1027&k=KFamhBpmURTZpndhc0MI7_1l3a6Xezrf&authKey=Yenwm7%2B%2F%2FT%2BtSXCSyr%2B7fYS47Ot0MwFqesH4HOLT8ZADE2e9XO6AS96HQvjxh%2B%2BG&noverify=0&group_code=894957229) è”ç³»ç»´æŠ¤äººå‘˜å¯»æ±‚å¸®åŠ©**

## å¸¸è§é—®é¢˜

### no_socket with crypto

`no_socket`æŒ‡çš„æ˜¯æºä»£ç ä¸­æ²¡æœ‰å¼•å…¥`socket`ç›¸å…³çš„åº“ï¼Œå½“å¸Œæœ›è¾¾åˆ°çš„æ•ˆæœæ˜¯ç±»ä¼¼äºå½“ç”¨æˆ·é€šè¿‡ç‰¹å®šç«¯å£è¿æ¥åˆ°é¶æœºæ—¶ï¼Œå°±è¿è¡Œpythonä»£ç ï¼Œå¹¶å°†ä»£ç çš„è¿è¡Œç•Œé¢è½¬å‘ç»™ç”¨æˆ·ã€‚

å¦‚æœå·²ç»å¼•å…¥äº†`socket`ç›¸å…³çš„åº“ï¼Œè¯·ç›´æ¥ä½¿ç”¨å¦‚`python app.py`è¿™ç±»è¯­å¥å¯åŠ¨pythonç¨‹åºï¼Œå¹¶è®©ç¨‹åºè‡ªè¡Œç›‘å¬ç‰¹å®šç«¯å£ã€‚

### è½¯ä»¶æºæ¢æº

ç¯å¢ƒä¸­æ¶‰åŠè½¯ä»¶åŒ…å¤„ç†çš„æƒ…å½¢ï¼Œå¦‚aptã€yumï¼Œå‡å·²æ¢æºä¸ºustcæºï¼Œå¦‚ä¸å¤„äºä¸­å›½å¤§é™†ç½‘ç»œç¯å¢ƒ/å¯ç”¨äº†å…¨å±€ä»£ç†ç¯å¢ƒï¼Œè¯·è‡ªè¡Œä¿®æ”¹ç›¸å…³æ¢æºè¯­å¥ï¼Œé¿å…ç”±äºè¿˜åŸå¸¦æ¥çš„è´Ÿä¼˜åŒ–ã€‚

### æ—¥å¿—shæ–‡ä»¶é”™è¯¯

ç”±äºDOS/Windows å’Œ Linux/Unixçš„æ–‡ä»¶æ¢è¡Œå›è½¦æ ¼å¼ä¸åŒï¼Œä»è€Œé€ æˆLinuxçš„Dockerå‡ºç°ä¸‹é¢çš„æŠ¥é”™ï¼š

```bash
/docker-entrypoint.sh: line 2: $'\r': command not found
/docker-entrypoint.sh: line 26: syntax error: unexpected end of file
```

> [!NOTE]
> DOS/Windows çš„æ–‡æœ¬æ–‡ä»¶åœ¨æ¯ä¸€è¡Œæœ«å°¾æœ‰ä¸€ä¸ª CRï¼ˆå›è½¦ï¼‰å’Œ LFï¼ˆæ¢è¡Œï¼‰ï¼Œè€Œ UNIX æ–‡æœ¬åªæœ‰ä¸€ä¸ªLFï¼ˆæ¢è¡Œï¼‰

è§£å†³æ–¹æ¡ˆå¦‚ä¸‹:

```bash
sed -i ""s/\r//"" docker-entrypoint.sh
```

å³é€šè¿‡æ­£åˆ™åŒ¹é…ï¼Œç›´æ¥æ›¿æ¢æ‰ `\r` å­—ç¬¦ï¼Œä¸è¿‡æ­¤æ–¹æ¡ˆä¸ä¸€å®šèƒ½å®Œå…¨è§£å†³é—®é¢˜ã€‚

å»ºè®®ç›´æ¥åœ¨linuxä¸‹æ‰§è¡Œ `git clone` æ“ä½œï¼Œæˆ–è€…ç›´æ¥ä»githubä¸‹è½½zipç‰ˆæœ¬çš„æºç ï¼Œé¿å…ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„ç¼–ç é—®é¢˜ã€‚

> [!WARNING]
> è¯·æ³¨æ„ï¼Œ`sed`æŒ‡ä»¤åœ¨`unixï¼ˆmacosï¼‰`ä¸‹çš„é¢„æœŸæ‰§è¡Œæ•ˆæœä¸`linux`ä¸‹çš„é¢„æœŸæ‰§è¡Œæ•ˆæœä¸åŒã€‚

## Detail

æ¯ä¸ªå®¹å™¨æ¨¡æ¿å‡ä¸ºç‹¬ç«‹å°è£…ï¼Œæ‚¨å¯ä»¥åœ¨æ¯ä¸ªå®¹å™¨æ¨¡æ¿æ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°å¯¹åº”çš„ README æ–‡ä»¶ï¼Œè¯·åœ¨ä½¿ç”¨å‰ä»”ç»†é˜…è¯»ï¼Œå¦‚æœ‰ä»»ä½•ç–‘é—®è¯·åŠ å…¥é¡¹ç›®ä¸­çš„  **[CTF-Archiveså”®åå¿«é€ŸæœåŠ¡ç¾¤](http://qm.qq.com/cgi-bin/qm/qr?_wv=1027&k=KFamhBpmURTZpndhc0MI7_1l3a6Xezrf&authKey=Yenwm7%2B%2F%2FT%2BtSXCSyr%2B7fYS47Ot0MwFqesH4HOLT8ZADE2e9XO6AS96HQvjxh%2B%2BG&noverify=0&group_code=894957229)**  è”ç³»ç»´æŠ¤äººå‘˜è·å–å¸®åŠ©ã€‚

å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿåœ¨ [**Hello-CTF å‘½é¢˜éƒ¨åˆ†**](https://hello-ctf.com/Create/) é¡µé¢æä¾›å‘½é¢˜ç›¸å…³çš„æ•™ç¨‹ï¼Œä¹Ÿé™„å¸¦æœ¬é¡¹ç›®çš„æ‰€æœ‰æ–‡æ¡£ï¼Œæ¬¢è¿è®¿é—®æŸ¥é˜…ã€‚

> [!NOTE]
>
> åœ¨æ— ç‰¹æ®Šå£°æ˜çš„æƒ…å†µä¸‹ï¼Œå®Œæˆä½¿ç”¨ä¸­æåŠå¯¹åº”æ¨¡æ¿çš„å¿…è¦æ­¥éª¤å,æ‰§è¡Œåç»­æ“ä½œï¼š
>
> ```shell
> docker build .
> ```
>
> å¼€å§‹ç¼–è¯‘é•œåƒã€‚
>
> ä¹Ÿå¯ä»¥åœ¨å®‰æ”¾å¥½ç›¸å…³é¡¹ç›®æ–‡ä»¶ä¹‹åï¼Œç›´æ¥ä½¿ç”¨ `./docker/docker-compose.yml` å†…çš„ `docker-compose` æ–‡ä»¶å®ç°ä¸€é”®å¯åŠ¨æµ‹è¯•å®¹å™¨ã€‚
>
> ```shell
> cd ./docker
> docker-compose up -d
> ```
>
> **ç‰¹åˆ«æ³¨æ„ï¼ï¼**
>
> **å¯¹äºPythonç›¸å…³ç¯å¢ƒï¼Œå¦‚ä½¿ç”¨äº† ç¬¬ä¸‰æ–¹åº“ï¼Œè¯·å…ˆåœ¨ `./Dockerfile` å†…è¡¥å…… pip å®‰è£…è¯­å¥ã€‚**
>
> **å¤§éƒ¨åˆ†é¡¹ç›®å¯¹SRCæ–‡ä»¶ä¸­éœ€æ±‚çš„ ç¨‹åº / è„šæœ¬ æ–‡ä»¶æœ‰ç‰¹å®šå‘½åè¦æ±‚ï¼Œè¯·ä»”ç»†é˜…è¯»æ‚¨æ‰€ç”¨æ¨¡æ¿çš„ README æ–‡ä»¶ã€‚**

### Crypto

#### python_3.8/3.10-no_socket / with_socket

**ç¯å¢ƒï¼š**

æä¾› `Python 3.8 / Python 3.10` çš„åŸºç¡€ç¯å¢ƒï¼Œå¹¶å·²ç»æ·»åŠ  `pycryptodome` åº“ï¼Œå¹¶åŸºäºé¡¹ç›®æœ¬èº«å®ç°ç›¸å…³æ¥å£ã€‚

*å®ç°*ï¼šå½“é€‰æ‰‹è¿æ¥åˆ°å¯¹åº”æœåŠ¡ç«¯å£ï¼ˆç”±é¡¹ç›®è‡ªè¡Œå®šä¹‰ï¼‰çš„æ—¶å€™ï¼Œè¿è¡Œ `.pyé¡¹ç›®`

**with_socket** é€‚ç”¨äºé¡¹ç›®ä¸­å¼•å…¥äº† `socket` ç­‰åº“ï¼Œéœ€è¦é•œåƒåšåˆ°ï¼š

- é€‰æ‰‹é€šè¿‡ç«¯å£è¿æ¥åˆ°å®¹å™¨/é¶æœº
- å¯åŠ¨é¡¹ç›®
- é¡¹ç›®è‡ªè¡Œå¤„ç†ä¼šè¯

**no_socket** é€‚ç”¨äºé¡¹ç›®ä¸­æ²¡æœ‰å¼•å…¥ `socket` ç­‰åº“ï¼Œéœ€è¦é•œåƒåšåˆ°ï¼š

- é€‰æ‰‹é€šè¿‡ç«¯å£è¿æ¥åˆ°å®¹å™¨/é¶æœº
- æœåŠ¡å¯åŠ¨é¡¹ç›®ï¼Œç”ŸæˆPythonä¼šè¯
- å°†ä¼šè¯è½¬å‘ç»™é€‰æ‰‹çš„è¿æ¥

**ä½¿ç”¨ï¼š**

å°†pyæ–‡ä»¶/é¡¹ç›®æ”¾å…¥ `./src` ç›®å½•åæ‰§è¡Œåç»­æ“ä½œï¼Œæ–‡ä»¶åå»ºè®®ä½¿ç”¨ `main.py` ï¼Œä¾¿äºç¯å¢ƒè¯†åˆ«ï¼Œå¦‚éœ€æ›´æ”¹æ–‡ä»¶åï¼Œè¯·åœ¨ `./service/docker-entrypoint.sh` å†…æ›´æ”¹ã€‚

### sagemath_9.6

**ç¯å¢ƒï¼š**

æä¾› `SageMath 9.6` + `Python 3.10.3` çš„åŸºç¡€ç¯å¢ƒï¼Œå¹¶å·²ç»æ·»åŠ  `pycryptodome` + `gmpy2` åº“ï¼Œå¹¶åŸºäº `socat` å®ç°æœåŠ¡è½¬å‘ï¼Œé»˜è®¤æš´éœ²ç«¯å£ä½äº9999

å®ç°ï¼šå½“é€‰æ‰‹è¿æ¥åˆ°å¯¹åº”ç«¯å£ï¼ˆé»˜è®¤ä¸º9999ç«¯å£ï¼Œé»˜è®¤é€‰æ‰‹ä½¿ç”¨ `netcat` ï¼‰çš„æ—¶å€™ï¼Œè¿è¡Œ `.pyé¡¹ç›®`ï¼Œå¹¶å°†ä¼šè¯è½¬å‘è‡³é€‰æ‰‹çš„è¿æ¥

æ­¤ç¯å¢ƒé€‚ç”¨äºé¡¹ç›®ä¸­æ²¡æœ‰å¼•å…¥ `socket` ç­‰åº“ï¼Œå¹¶ä¾èµ–äº `SageMath` æ ¸å¿ƒï¼Œéœ€è¦é•œåƒåšåˆ°ï¼š

- é€‰æ‰‹é€šè¿‡ç«¯å£è¿æ¥åˆ°å®¹å™¨/é¶æœº

- æœåŠ¡å¯åŠ¨é¡¹ç›®ï¼Œç”ŸæˆSageMathä¼šè¯

- å°†ä¼šè¯è½¬å‘ç»™é€‰æ‰‹çš„è¿æ¥

**ä½¿ç”¨ï¼š**

ç›´æ¥å°†SageMathæ–‡ä»¶/é¡¹ç›®æ”¾å…¥ `./src` ç›®å½•åæ‰§è¡Œåç»­æ“ä½œï¼Œæ–‡ä»¶åå»ºè®®ä½¿ç”¨ `main.sage` ï¼Œä¾¿äºç¯å¢ƒè¯†åˆ«ï¼Œå¦‚éœ€æ›´æ”¹æ–‡ä»¶åï¼Œè¯·åœ¨ `./service/docker-entrypoint.sh` å†…æ›´æ”¹

### KOHï¼ˆNSSCTF_Onlyï¼‰

KOHé¢˜ç›®æ˜¯åŸºäºHTTPæœåŠ¡ä¸åç«¯è¯„åˆ¤ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„,æ•…é¢˜ç›®å®¹å™¨éœ€è¦å¯åŠ¨ä¸€ä¸ªæ ‡å‡†çš„HTTPæœåŠ¡ï¼Œå¹¶å¯¹å¤–æš´éœ²HTTPæœåŠ¡ç«¯å£ã€‚

ä¸ºäº†ç¡®ä¿é¢˜ç›®èƒ½å¤Ÿæ­£å¸¸ä¸åç«¯è¿›è¡Œäº¤äº’ï¼ŒHTTPæœåŠ¡éœ€è¦åŒ…å«ä»¥ä¸‹è·¯ç”±å¹¶è¿›è¡Œç›¸åº”å¤„ç†ï¼š

**upload:**

```python
@app.route('/upload', methods=['POST'])
def upload():
 pass
```

è¯¥è·¯ç”±è´Ÿè´£æ¥æ”¶ç”¨æˆ·ä¸Šä¼ çš„æ•°æ®ã€‚æ•°æ®å°†ä»¥è¡¨å•æ•°æ®çš„å½¢å¼è¿›è¡Œä¸Šä¼ ï¼Œå‚æ•°åä¸ºfileã€‚

ä¾‹å¦‚ï¼Œåç«¯å‘å®¹å™¨å†…çš„HTTPæœåŠ¡å‘é€è¯·æ±‚çš„ä»£ç å¦‚ä¸‹ï¼Œå…¶ä¸­è¶…æ—¶æ—¶é—´ä¸º5ç§’ï¼š

```python
requests.post(f'http://{url}/upload', files={
'file': (filename, content)
}, timeout=5)
```

å¦‚æœHTTPæœåŠ¡åœ¨5ç§’å†…æ­£å¸¸å¤„ç†è¯¥è·¯ç”±ï¼Œå¹¶ä¸”æ²¡æœ‰å¼‚å¸¸å‘ç”Ÿï¼Œåº”è¿”å›ä»¥ä¸‹JSONæ•°æ®ï¼š

```json
{
 "code": 200
}
```

å¦‚æœé‡åˆ°å¼‚å¸¸ï¼ˆä¾‹å¦‚æœåŠ¡å¼‚å¸¸ã€è¿æ¥å¼‚å¸¸ã€è¶…æ—¶å¼‚å¸¸ã€è¿”å›å€¼å¼‚å¸¸ï¼‰ï¼Œåˆ™ç›´æ¥åˆ¤å®šæ­¤æ¬¡ç»“æœä¸º**é”™è¯¯**ã€‚

ï¼ˆä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ200ä»¥å¤–çš„ä»»ä½•è¿”å›ä»£ç ï¼Œæˆ‘ä»¬éƒ½è®°ä¸º **é”™è¯¯** ï¼‰

**check:**

```python
@app.route('/check', methods=['POST'])
def check():
 pass
```

å½“åç«¯å®Œæˆå¯¹/uploadè·¯ç”±çš„è®¿é—®ä¸”æ²¡æœ‰å¼‚å¸¸æ—¶ï¼Œå°†è®¿é—®/checkè·¯ç”±ã€‚è®¿é—®ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

```python
requests.post(f'http://{url}/check', timeout=10)
```

è¶…æ—¶æ—¶é—´ä¸º**10**ç§’ã€‚é¶æœºéœ€è¦åœ¨æ­¤æ—¶é—´å†…è¯„ä¼°ç”¨æˆ·ä¸Šä¼ å†…å®¹çš„å¾—åˆ†æƒ…å†µï¼Œå¹¶è¿”å›JSONç»“æœï¼Œä¾‹å¦‚ï¼š

```json
{
 "code": 200,
 "score": 100
}
```

å¦‚æœé‡åˆ°å¼‚å¸¸ï¼ˆä¾‹å¦‚æœåŠ¡å¼‚å¸¸ã€è¿æ¥å¼‚å¸¸ã€è¶…æ—¶å¼‚å¸¸ã€è¿”å›å€¼å¼‚å¸¸ï¼‰ï¼Œåˆ™ç›´æ¥åˆ¤å®šæ­¤æ¬¡ç»“æœä¸º**é”™è¯¯**ã€‚å¦‚æœä»¥ä¸Šè¿‡ç¨‹æ²¡æœ‰å¼‚å¸¸ï¼Œåˆ¤æ–­è¿‡ç¨‹ç»“æŸï¼Œå¹¶å°†å¾—åˆ°çš„scoreæ›´æ–°ä¸ºç”¨æˆ·çš„å¾—åˆ†ã€‚

- åˆ¤é¢˜é¶æœºç›®å‰ä¸ºä¸€äººä¸€æœºï¼Œä¸Šæ¬¡åˆ¤é¢˜å®Œæˆå‰æ— æ³•ä¸Šä¼ æ–°çš„æ–‡ä»¶ï¼Œæ— éœ€è€ƒè™‘å¤šçº¿ç¨‹ä»¥åŠèµ„æºæŠ¢å çš„æƒ…å†µã€‚

- åº”å°½å¯èƒ½ä¿è¯æœåŠ¡çš„å¯ç”¨æ€§ã€‚å¯¹äºéœ€è¦è¿è¡Œæ—¶è¦æ±‚çš„é¶æœºï¼Œåº”ä½¿ç”¨chrootç­‰æ²™ç›’æŠ€æœ¯æ¥è¿è¡Œç‹¬ç«‹çš„è¿›ç¨‹ï¼Œä»¥é˜²æ­¢ç”¨æˆ·ä»£ç ç›´æ¥æ§åˆ¶é¶æœºæ¥æ§åˆ¶HTTPæœåŠ¡çš„è¿”å›å€¼ã€‚

- HTTPè¿”å›æ•°æ®åº”ç¡®ä¿è¿”å›å¤´åŒ…å«Content-Type: application/jsonå¤´ï¼Œè€Œä¸æ˜¯ç›´æ¥è¿”å›JSONå­—ç¬¦ä¸²ã€‚

**DockerFileæ–‡ä»¶è¯´æ˜:**

è¯¥é¢˜ä¸ºæ–‡ä»¶ä¸Šä¼ KOHé¢˜ï¼Œæ•…åªéœ€è¦å®Œæˆä¿å­˜æ–‡ä»¶ æ¯”è¾ƒæ–‡ä»¶å³å¯åˆ¤æ–­å¾—åˆ†ï¼Œå¦‚æœéœ€è¦è¿›è¡Œä»£ç æ‰§è¡Œï¼Œå¯ä»¥å‚è€ƒapp.pyä¸­æ³¨é‡Šä»£ç ä¸­ä½¿ç”¨subprocesså»ºç«‹chrootæ²™ç›’çš„æ–¹å¼è¿›è¡Œæ‰§è¡Œã€‚

æ³¨æ„ä¸ºäº†å®‰å…¨èµ·è§ï¼Œåœ¨Dockerfileä¸­åˆ é™¤äº†ä¸€äº›åŒ…ï¼Œå¦‚æœ‰ä½¿ç”¨éœ€è¦è¯·æ‰‹åŠ¨æ›´æ”¹ã€‚

```bash
RUN rm -f /home/ctf/usr/local/lib/python3.10/sockert.py && \
rm -f /home/ctf/usr/local/lib/python3.10/sockertserver.py && \
rm -rf /home/ctf/usr/local/lib/python3.10/site-package && \
rm -f /home/ctf/usr/local/lib/python3.10/subprocess.py
```

è¯¥é¶æœºä¸ºpython3é¶æœºï¼Œå¦‚éœ€ä½¿ç”¨å…¶ä»–ç¯å¢ƒï¼Œå…³äºchrootéƒ¨åˆ†ä¾ç„¶å¯ä»¥å‚è€ƒDockerfileä¸­å¯¹/home/ctfçš„æ”¹é€ æ–¹æ³•ï¼ˆ/home/ctfå³ä¸ºæ²™ç›’ç¯å¢ƒæ ¹ç›®å½•ï¼‰

### MISC

#### pyjail-python_3.10-socat / xinetd

**æ„Ÿè°¢ [@gtg2619](https://github.com/gtg2619) å¸ˆå‚…å¯¹æ­¤æ¨¡æ¿çš„è´¡çŒ®**

**ç¯å¢ƒï¼š**

æä¾› `Python 3.10` çš„åŸºç¡€ç¯å¢ƒï¼Œå¹¶å·²ç»æ·»åŠ  `pycryptodome` åº“ï¼Œå¹¶åŸºäº `socat`  / `xinetd` å®ç°æœåŠ¡è½¬å‘ï¼Œé»˜è®¤æš´éœ²ç«¯å£ä½äº9999

å®ç°ï¼šå½“é€‰æ‰‹è¿æ¥åˆ°å¯¹åº”ç«¯å£ï¼ˆé»˜è®¤ä¸º9999ç«¯å£ï¼Œé»˜è®¤é€‰æ‰‹ä½¿ç”¨ `netcat` ï¼‰çš„æ—¶å€™ï¼Œè¿è¡Œ `server.py`ï¼Œå¹¶å°†ä¼šè¯è½¬å‘è‡³é€‰æ‰‹çš„è¿æ¥

é•œåƒåšåˆ°ï¼š

- é€‰æ‰‹é€šè¿‡ç«¯å£è¿æ¥åˆ°å®¹å™¨/é¶æœº
- `socat`  / `xinetd` æœåŠ¡æ£€æµ‹åˆ°è¿æ¥ï¼Œå¯åŠ¨ä¸€ä¸ª `python3` ä¼šè¯
- `python3` é€šè¿‡å‚æ•° `-u /home/ctf/server.py` é™åˆ¶äº†ç¨‹åºè¿è¡Œæ—¶çš„è´¦æˆ·æƒé™ä¸º`ctf`ï¼Œç„¶ååœ¨é™åˆ¶ç¯å¢ƒä¸­å¯åŠ¨ç¨‹åº
- `socat`  / `xinetd` å°†ç¨‹åºä¼šè¯è½¬å‘ç»™é€‰æ‰‹çš„è¿æ¥

**ä½¿ç”¨ï¼š**

å°†ç¨‹åºæ–‡ä»¶æ”¾å…¥ `./src` ç›®å½•åæ‰§è¡Œåç»­æ“ä½œï¼Œæ–‡ä»¶åè¯·ä¿®æ”¹ä¸º `server.py` ä½œä¸ºæ–‡ä»¶åï¼Œä¾¿äºé•œåƒå®šä½ç¨‹åºä½ç½®

å¦‚æœéœ€è¦æ›´æ”¹ä¸ºè‡ªå·±çš„æ–‡ä»¶åï¼Œéœ€è¦åœ¨ `./config/ctf.xinetd`ã€`./Dockerfile` å’Œ `./service/docker-entrypoint.sh` ä¸­è¿›è¡Œä¿®æ”¹

### PWN

#### ubuntu_16.04 /18.04 / 20.04 /22.04

**ç¯å¢ƒï¼š**

æä¾› `Ubuntu 16.04 GLIBC 2.23` / `Ubuntu 18.04 GLIBC 2.27` / `Ubuntu 20.04 GLIBC 2.31` / `Ubuntu 22.04 GLIBC 2.35` çš„åŸºç¡€ç¯å¢ƒï¼Œå¹¶å·²ç»æ·»åŠ  `lib32z1` + `xinetd` è½¯ä»¶åŒ…ï¼Œå¹¶åŸºäº `xinetd` å®ç°æœåŠ¡è½¬å‘ï¼Œé»˜è®¤æš´éœ²ç«¯å£ä½äº9999

å®ç°ï¼šå½“é€‰æ‰‹è¿æ¥åˆ°å¯¹åº”ç«¯å£ï¼ˆé»˜è®¤ä¸º9999ç«¯å£ï¼Œé»˜è®¤é€‰æ‰‹ä½¿ç”¨ `netcat` ï¼‰çš„æ—¶å€™ï¼Œè¿è¡Œ `ç¨‹åºæ–‡ä»¶`ï¼Œå¹¶å°†ä¼šè¯è½¬å‘è‡³é€‰æ‰‹çš„è¿æ¥

é•œåƒåšåˆ°ï¼š

- é€‰æ‰‹é€šè¿‡ç«¯å£è¿æ¥åˆ°å®¹å™¨/é¶æœº
- xintedæœåŠ¡æ£€æµ‹åˆ°è¿æ¥ï¼Œå¯åŠ¨ä¸€ä¸ª `chroot` ä¼šè¯
- `chroot` é€šè¿‡å‚æ•° `--userspec=1000:1000 /home/ctf` é™åˆ¶äº†ç¨‹åºè¿è¡Œæ—¶çš„è´¦æˆ·æƒé™ï¼Œå¹¶æ›´æ”¹äº†ç¨‹åºè¿è¡Œæ—¶çš„rootæ ¹ç›®å½•ç¯å¢ƒä½ç½®ä¸º `/home/ctf` ï¼Œç„¶ååœ¨é™åˆ¶ç¯å¢ƒä¸­å¯åŠ¨ç¨‹åº
- `xinted` å°†ç¨‹åºä¼šè¯è½¬å‘ç»™é€‰æ‰‹çš„è¿æ¥

**ä½¿ç”¨ï¼š**

å°†ç¨‹åºæ–‡ä»¶æ”¾å…¥ `./src` ç›®å½•å³å¯ï¼Œæ–‡ä»¶åè¯·ä¿®æ”¹ä¸º `attachment` ä½œä¸ºæ–‡ä»¶åï¼Œä¾¿äºé•œåƒå®šä½ç¨‹åºä½ç½®

å¦‚æœéœ€è¦æ›´æ”¹ä¸ºè‡ªå·±çš„æ–‡ä»¶åï¼Œéœ€è¦åœ¨ `./config/ctf.xinetd`ã€`./Dockerfile` å’Œ `./service/docker-entrypoint.sh` ä¸­è¿›è¡Œä¿®æ”¹

### Web

#### flask-python_3.8 / 3.10

æä¾› `Python 3.8 + Flask` /  `Python 3.10 + Flask` çš„åŸºç¡€ç¯å¢ƒï¼Œé»˜è®¤æš´éœ²ç«¯å£ä½äº8080

ç›´æ¥å°†Flaskæ–‡ä»¶/é¡¹ç›®æ”¾å…¥ `./src` ç›®å½•å³å¯ï¼ŒFlaské¡¹ç›®ä¸»æ–‡ä»¶è¯·ä½¿ç”¨ `app.py` ä½œä¸ºæ–‡ä»¶åï¼Œä¾¿äºç¯å¢ƒè¯†åˆ«Flaské¡¹ç›®ä½ç½®

å¦‚ä½¿ç”¨äº† `pycryptodome` ç­‰ç¬¬ä¸‰æ–¹åº“ï¼Œè¯·åœ¨ `./Dockerfile` å†…è¡¥å……pipå®‰è£…è¯­å¥

#### java-openjdk8

æä¾› `Openjdk 1.8.0` çš„åŸºç¡€ç¯å¢ƒï¼Œé»˜è®¤æœåŠ¡æš´éœ²ç«¯å£ç”±ç¨‹åºå†³å®š

é€‚ç”¨äºåŸºäº `jar` ç¨‹åºåŒ…éƒ¨ç½²ç¯å¢ƒçš„éœ€æ±‚

ç›´æ¥å°† `jar` ç¨‹åºåŒ…æ”¾å…¥ `./src` ç›®å½•å³å¯ï¼Œjarç¨‹åºåŒ…è¯·ä½¿ç”¨ `app.jar` ä½œä¸ºæ–‡ä»¶åï¼Œä¾¿äºç¯å¢ƒè¯†åˆ« `jar` ç¨‹åºåŒ…

#### jetty-jdk8

æä¾› `Jetty 9.4.49 Openjdk 1.8.0` çš„åŸºç¡€ç¯å¢ƒï¼Œé»˜è®¤æœåŠ¡æš´éœ²ç«¯å£ç”±ç¨‹åºå†³å®š

é€‚ç”¨äºåŸºäº `war` ç¨‹åºåŒ…éƒ¨ç½²ç¯å¢ƒçš„éœ€æ±‚

ç›´æ¥å°† `war` ç¨‹åºåŒ…æ”¾å…¥ `./src` ç›®å½•å³å¯ï¼Œwarç¨‹åºåŒ…è¯·ä½¿ç”¨ `root.war` ä½œä¸ºæ–‡ä»¶åï¼Œä¾¿äºç¯å¢ƒè¯†åˆ« `war` ç¨‹åºåŒ…

#### tomcat-jdk8

æä¾› `Tomcat 9.0.78 Openjdk 1.8.0` çš„åŸºç¡€ç¯å¢ƒï¼Œé»˜è®¤æœåŠ¡æš´éœ²ç«¯å£ç”±ç¨‹åºå†³å®š

é€‚ç”¨äºåŸºäº `war` ç¨‹åºåŒ…éƒ¨ç½²ç¯å¢ƒçš„éœ€æ±‚

ç›´æ¥å°† `war` ç¨‹åºåŒ…æ”¾å…¥ `./src`

#### LAMP-php80 / LNMP-php73 / nginx-php73

> éƒ¨åˆ†å®¹å™¨å‚è€ƒ [CTF Training](https://github.com/CTFTraining/) æ„Ÿè°¢ **[é™Œç«¹ - mozhu1024](https://github.com/mozhu1024)** å¸ˆå‚… å’Œ **[èµµæ€» - glzjin](https://github.com/glzjin)** å¸ˆå‚…åšå‡ºçš„è´¡çŒ®

`Apache2` +`PHP 8.0.30`+`10.5.21-MariaDB` çš„åŸºç¡€ç¯å¢ƒï¼Œé»˜è®¤æš´éœ²ç«¯å£ä½äº 80

- L: Linux alpine
- A: Apache2
- M: MySQL
- P: PHP 8.0
- PHP MySQL Ext
  - mysql
  - mysqli

`Nginx` +`PHP 7.3.33`+`10.6.14-MariaDB` çš„åŸºç¡€ç¯å¢ƒï¼Œé»˜è®¤æš´éœ²ç«¯å£ä½äº 80

- L: Linux alpine
- N: Nginx
- M: MySQL
- P: PHP 7.3
- PHP MySQL Ext
  - mysql
  - mysqli

`Nginx` +`PHP 7.3.33` çš„åŸºç¡€ç¯å¢ƒï¼Œé»˜è®¤æš´éœ²ç«¯å£ä½äº 80

ç›´æ¥å°† PHP é¡¹ç›®æ”¾å…¥ `./src` ç›®å½•åæ‰§è¡Œåç»­æ“ä½œã€‚

> [!CAUTION]
>
> **æ³¨æ„ï¼ï¼**
>
> **æ¨¡æ¿é»˜è®¤ä¼šå°† flag ä¿å­˜åœ¨ æ•°æ®åº“ä¸­ï¼Œå¦‚æœ éœ€è¦æ”¹å˜flagåœ¨æ•°æ®åº“ä¸­çš„å­˜æ”¾ä½ç½®ï¼Œè¯·åœ¨./service/docker-entrypoint.sh ä¸­ä¿®æ”¹ç›¸å…³æ“ä½œè¯­å¥**

## A little advertisement

æŸ [Randark-JMT](https://github.com/Randark-JMT) å¯ä»¥æ— å¿ä¸ºCTFå¹³å°æ­å»ºã€é¢˜ç›®æ‰“åŒ…æä¾›ä¸€å®šå¸®åŠ©ï¼Œæ¬¢è¿è”ç³»ğŸ˜˜

## å‚è€ƒä¸é¸£è°¢

[https://github.com/CTFTraining](https://github.com/CTFTraining)

æ„Ÿè°¢**glzjin-èµµæ€»**å’Œ**mozhu1024-é™Œç«¹**å¸ˆå‚…ä»¬çš„é¡¹ç›®ï¼Œæ ¹æ®ä¸Šè¿°ä»“åº“ï¼Œæ­¤é¡¹ç›®æ‰æœ‰äº†é›å½¢ï¼Œæ„Ÿè°¢ä»–ä»¬ä¸ºCTFäº‹ä¸šåšå‡ºçš„å·¨å¤§è´¡çŒ®

[qsnctf / qsnctf_base_docker_images é’å°‘å¹´CTFåŸºç¡€Dockeré•œåƒ](https://github.com/qsnctf/qsnctf_base_docker_images)

æ„Ÿè°¢ **æœ«å¿ƒ** å¸ˆå‚…å¯¹ç›¸å…³æ¨¡æ¿ä½œå‡ºçš„å»ºè®®ä¸åŠªåŠ›
